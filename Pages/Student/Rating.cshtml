@page
@model PRAKTOSWEBAPI.Pages.Student.RatingModel
@{
    ViewData["Title"] = "Рейтинг";
}

<div class="card">
    <div class="card-header">
        <i class="fas fa-trophy"></i> Рейтинг абитуриентов
    </div>
    
    <div class="form-group" style="margin-bottom: 1.5rem;">
        <label class="form-label">Выберите специальность:</label>
        <select class="form-control" id="specialtyFilter" style="max-width: 300px;">
            <option value="0">Все специальности</option>
            @foreach (var specialty in Model.Specialties)
            {
                <option value="@specialty.Id">@specialty.Name</option>
            }
        </select>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Место</th>
                    <th>ФИО</th>
                    <th>Специальность</th>
                    <th>Средний балл</th>
                    <th>Статус заявки</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Ratings)
                {
                    <tr data-specialty="@item.SpecialtyId">
                        <td><strong>#@item.Rank</strong></td>
                        <td>@item.FullName</td>
                        <td>@item.SpecialtyName</td>
                        <td><strong>@item.AverageScore.ToString("F2")</strong></td>
                        <td>
                            <span class="badge @(item.Status == "Approved" ? "badge-success" : item.Status == "Rejected" ? "badge-danger" : "badge-warning")">
                                @(item.Status == "Approved" ? "Одобрено" : item.Status == "Rejected" ? "Отклонено" : "На рассмотрении")
                            </span>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('specialtyFilter')?.addEventListener('change', function() {
            const selectedSpecialty = this.value;
            const rows = document.querySelectorAll('tbody tr');
            
            rows.forEach(row => {
                if (selectedSpecialty === '0' || row.getAttribute('data-specialty') === selectedSpecialty) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });
    </script>
}

